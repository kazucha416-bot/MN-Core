d set $lm0n0c0b0m0p0 7 3ff4cccccccccccd3f50624dd2f1a9fc3ff00000000000003ff00000000000003ff00000000000003ff00000000000003eb0c6f7a0b5ed8d
d set $ln0n0c0b0m0p0 3 00000000000000003eb0c6f7a0b5ed8d3fe0000000000000
d set $lr0n0c0b0m0p0 2 40100000000000004010000000000000
d set $ls0n0c0b0m0p0 3 403800000000000040480000000000003ff8000000000000


drsqrt $lm0 $lr4
nop/2
# N法1回目
dvmulu $lr4 $lr4 $ls6
nop/2
dvmulu $lm0 $ls6 $lr6
nop/2
dvfmau $lr6 -$ln4 $ls4 $nowrite
dvmulu $mauf $lr4 $lr4
nop/2
# N法2回目
dvmulu $lr4 $lr4 $ls6
nop/2
dvmulu $lm0 $ls6 $lr6
nop/2
dvfmau $lr6 -$ln4 $ls4 $nowrite
dvmulu $mauf $lr4 $lr4
nop/2
# N法3回目
dvmulu $lr4 $lr4 $ls6
nop/2
dvmulu $lm0 $ls6 $lr6
nop/2
dvfmau $lr6 -$ln4 $ls4 $nowrite
dvmulu $mauf $lr4 $lr4
nop/2
# 補正した1/rが求まったので，r2i,r6iを求めていく
dvmulu $lr4 $lr4 $nowrite
dvmulu $mauf $mauf $lr8 # Final r2i
nop/2
dvmulu $lr8 $lr8 $nowrite
dvmulu $mauf $lr8 $lr10 # Final r6i
nop/2
dvmulu $lr10 $lr10 $lr12 # Final r12i
nop
# calculate fc
dvmulu $ls0 $lr10 $nowrite
dvfmau $ls2 $lr12 -$mauf $nowrite
dvmulu $mauf $lr8 $ls8 # fc
nop/2
# calculate f1
dvmulu $ls8 $lm0 $ls10 # f1 = fc * x
# calculate 0.5 * h^2
dvmulu $ln2 $lm12 $lr14 # h^2 * 0.5
nop
dvmulu $ls10 $lm10 $ls12 # f1 / mass
nop/2
# upadate position
dvfmau $lr14 $ls12 $lm0 $nowrite
dvfmau $lm2 $ln0 $mauf $nowrite
dvpassa $mauf $lm0
nop/2
# Newton-Raphson to New position
drsqrt $lm0 $lr4
nop/2
# N法1回目
dvmulu $lr4 $lr4 $ls6
nop/2
dvmulu $lm0 $ls6 $lr6
nop/2
dvfmau $lr6 -$ln4 $ls4 $nowrite
dvmulu $mauf $lr4 $lr4
nop/2
# N法2回目
dvmulu $lr4 $lr4 $ls6
nop/2
dvmulu $lm0 $ls6 $lr6
nop/2
dvfmau $lr6 -$ln4 $ls4 $nowrite
dvmulu $mauf $lr4 $lr4
nop/2
# N法3回目
dvmulu $lr4 $lr4 $ls6
nop/2
dvmulu $lm0 $ls6 $lr6
nop/2
dvfmau $lr6 -$ln4 $ls4 $nowrite
dvmulu $mauf $lr4 $lr4
nop/2
# 補正した 1/xnew が求まったので，r2inew,r6inewを求めていく
dvmulu $lr4 $lr4 $nowrite
dvmulu $mauf $mauf $lr8 # Final r2inew
nop/2
dvmulu $lr8 $lr8 $nowrite
dvmulu $mauf $lr8 $lr10 # Final r6inew
nop/2
dvmulu $lr10 $lr10 $lr12 # Final r12inew
nop
# calculate New fc
dvmulu $ls0 $lr10 $nowrite
dvfmau $ls2 $lr12 -$mauf $nowrite
dvmulu $mauf $lr8 $ls8 # New fc
nop/2
# calculate f2 = fc * xnew
dvmulu $ls8 $lm0 $lr16 # f2 = fc * xnew
# update velocity (v = v + 0.5 * dt / mass * (f1 + f2))
dvmulu $ln4 $lm2 $lr18 # 0.5 * h
nop
dvadd $ls10 $lr16 $nowrite # f1 + f2
dvmulu $mauf $lm10 $nowrite # (f1 + f2) / mass
dvfmau $mauf $lr18 $ln0 $ln0 # velocity update
# ready for the next step
dvpassa $lr16 $ls10 # f1 = f2
# calculate potential energy (pe = ce12 * r12i - ce06 * r06i)
dvpassa $lr2 $nowrite
dvmulu $mauf $lr12 $ls20
nop
dvpassa $lr10 $nowrite
dvfmau $mauf -$lr0 $ls20 $lm14 # potential energy
nop/2
# calculate kinetic energy (ke = 0.5 * mass * (v * v))
dvmulu $ln4 $lm4 $lr22
nop
dvmulu $ln0 $ln0 $nowrite 
dvmulu $mauf $lr22 $lm16 # kinetic energy
nop/2
# total energy
dvpassa $lm16 $nowrite # kinetic energy
dvadd $mauf $lm14 $nowrite # total energy
dvpassa $mauf $lm18 # set total energy
nop/2
l1bmm@0 $lm18 $lb0

d getd $lm0n0c0b0m0p0 10
d getd $ln0n0c0b0m0p0 4
d getd $lr0n0c0b0m0p0 12
d getd $ls0n0c0b0m0p0 8
d getd $lb0n0c0b0 2